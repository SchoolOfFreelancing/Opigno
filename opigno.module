<?php

/**
 * @file
 * Contains all hook_implementations.
 */

/**
 * @todo
 *  - Add new permission + callback for views pages
 *  - Add views to install (Features ?)
 */
 
/**
 * Implements hook_menu()
 */
function opigno_menu() {
  $menu = array();
  
  return $menu;
}

/**
 * Implements hook_block_info()
 */
function opigno_block_info() {
  return array(
    'course_tools' => array(
      'info' => t("Course tools"),
      'cache' => DRUPAL_CACHE_PER_PAGE
    )
  );
}

/**
 * Implements hook_block_view()
 */
function opigno_block_view($delta) {
  module_load_include('inc', 'opigno', 'includes/opigno.block');
  
  switch ($delta) {
    case 'course_tools':
      return opigno_course_tools_block();
  }
}

/**
 * Implements hook_theme()
 */
function opigno_theme() {
  return array(
    'opigno_og_tool' => array(
      'variables' => array('og_type' => NULL, 'machine_name' => NULL, 'name' => NULL, 'uri' => NULL),
      'template' => 'theme/opigno--og-tool'
    )
  );
}

/**
 * Custom title callback.
 * Generates a title based on the node title and page type.
 * 
 * @param object $node
 * 
 * @param string $type
 *        The page type. Can be 'wiki', 'quiz', 'workgroup', etc
 * 
 * @return string
 */
function opigno_node_title($node, $type) {
  $node_title = $node->title;
  
  switch($type) {
    case 'wiki':
      $objects = t("wikis");
      break;
      
    case 'files':
      $objects = t("documents");
      break;
      
    case 'quiz':
      $objects = t("assessments");
      break;
      
    default:
      $objects = t("content");
      break;
  }
  
  return t("@title !objects", array('@title' => $title, '!objects' => $objects));
}

/**
 * Custom access callback
 * Use the settings from og_access to determine if a user has access to the current
 * node.
 *
 * @param object $node
 *
 * @param string $type
 *        The page type. Can be 'wiki', 'quiz', 'workgroup', etc
 *
 * @return bool
 */
function opigno_node_access($node, $type) {
  return TRUE;
}
